function Z = S2Z(S,Z_0)
    Z11 = Z_0*  ( ( (1+S(1,1))*(1-S(2,2)) + (S(1,2)*S(2,1)) ) / ...
                ( ( (1-S(1,1))*(1-S(2,2)) - (S(1,2)*S(2,1)) ) ) );
    Z12 = Z_0*  ( (  2*S(1,2) ) / ...
                ( ( (1-S(1,1))*(1-S(2,2)) - (S(1,2)*S(2,1)) ) ) );
    Z21 = Z_0*  ( (  2*S(2,1) ) / ...
                ( ( (1-S(1,1))*(1-S(2,2)) - (S(1,2)*S(2,1)) ) ) );
    Z22 = Z_0*  ( ( (1-S(1,1))*(1+S(2,2)) + (S(1,2)*S(2,1)) ) / ...
                ( ( (1-S(1,1))*(1-S(2,2)) - (S(1,2)*S(2,1)) ) ) );
    Z = [Z11, Z12; Z21, Z22];
end

